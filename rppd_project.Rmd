---
title: "Untitled"
author: 'team id: 160'
date: "2024-06-01"
output: html_document
---

```{r beggining}
library(dplyr)
library(readxl)
library(readr)
library(ggplot2)
library(GGally)
library(jsonlite)
library(tidyr)
```

```{r prepare}
data <- read_csv("C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\dota2_proleague.csv")

data$isRadiant = as.integer(!is.na(data$isRadiant))
data$player_slot = NULL
data$account_id = NULL
data$additional_units = NULL
data$patch = NULL
data$region = NULL
data$account_id = NULL
data$lose = NULL
data$radiant_win = NULL
data$...1 = NULL
data = data %>% filter(`game_mode` == 2)

```

Q1 = –≤ –¥–∞–Ω–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ –æ—Å—Ç–∞–ª–æ—Å—å 200309 —É–Ω–∏–∞–ª—å–Ω—ã—Ö –º–∞—Ç—á–µ–π
```{r q1}
heroes <- read_csv("C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\heroes.csv")

uniq_match <- n_distinct(data$match_id)
uniq_match
```

Q2
–ú—ã –º–æ–∂–µ–º —É–¥–∞–ª–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é gold_spent, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ –Ω–µ –æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∏–∫–∞–∫–æ–≥–æ –≤–ª–∏—è–Ω–∏—è –Ω–∞ –Ω–∞—à—É –æ—Å–Ω–æ–≤–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é GPM. –ë–æ–ª–µ–µ —Ç–æ–≥–æ, gold_spent –Ω–µ –∏–º–µ–µ—Ç –Ω–∏–∫–∞–∫–æ–π —Å–≤—è–∑–∏ —Å –∏–Ω—ã–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏ –≤  data. –ú—ã –Ω–µ –º–æ–∂–µ–º —Å–¥–µ–ª–∞—Ç—å –Ω–∏–∫–∞–∫–∏—Ö –≤—ã–≤–æ–¥–æ–≤ –±–ª–∞–≥–æ–¥–∞—Ä—è –µ–π, –≤ —Å–ª–µ–¥—Å—Ç–≤–∏–µ —á–µ–≥–æ –æ–Ω–∞ —è–≤–ª—è–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–º –º—É—Å–æ—Ä–æ–º –∏ –µ–µ –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–Ω–Ω—ã—Ö.
```{r q2}
data$gold_spent = NULL
names(heroes)[names(heroes)== 'id']='hero_id'
dota2_data = merge(x = data, y = heroes, by = "hero_id", sort = T)


```

Q3
```{r q3}
max(dota2_data$gold_per_min, na.rm=T)
id1 <- dota2_data[dota2_data$gold_per_min == '1315',]
id1$hero_id

```

Q4
```{r q4}
agi <- dota2_data %>% filter(dota2_data$primary_attr == 'agi')
max(agi$gold_per_min, na.rm=T)
id2 <- agi[agi$gold_per_min == '1315',]
id2$hero_id
```

Q5.1
```{r q5}
melee <- dota2_data %>% filter(dota2_data$attack_type == 'Melee')
ranged <- dota2_data %>% filter(dota2_data$attack_type == 'Ranged')
mean(melee$gold_per_min)
mean(ranged$gold_per_min)
mean(melee$gold_per_min) > mean(ranged$gold_per_min)
```
Q5.2
–í –¥–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–µ –ø–æ-–º–æ–µ–º—É –º–Ω–µ–Ω–∏—é –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é mean, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –¥–∞—Å—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ —Ä–∞—Å—á–µ—Ç –∏  —É—á–µ—Å—Ç—å –∫–∞–∂–¥–æ–µ —á–∏—Å–ª–æ. –≠—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –≤–∞–∂–Ω—ã–º –≤ –¥–∞–Ω–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏, —Ç–∞–∫ –∫–∞–∫ –º—ã –æ–±—è–∑–∞–Ω—ã —Ä–∞—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —á—Ç–æ–±—ã –∏—Å–∫–ª—é—á–∏—Ç—å –Ω–µ–æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑—Ä—ã–≤ –≤ –∑–Ω–∞—á–µ–Ω–∏—è—Ö –º–µ–∂–¥—É –¥–≤—É–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏. –°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –ú–µ–¥–∏–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –Ω–µ —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è. –û–¥–Ω–∞–∫–æ –≤ –∏–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö , –æ—Ç–ª–∏—á–∏–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∫–æ–ª–æ—Å–∞–ª—å–Ω—ã–º–∏.

Q6
```{r q6}
dota2_data$kills_log <- lapply(dota2_data$kills_log, function(x) {
  tryCatch(
    fromJSON(gsub("'", '"', x)),  
    error = function(e) data.frame(time = numeric(), key = numeric())  
  )
})


time_values <- c()
median_free_times <- c()

for (i in 1:nrow(dota2_data)) {
  if (length(dota2_data$kills_log[[i]]) == 0) {
    median_free_time <- dota2_data$duration[i]
  } else {
    time_values <- dota2_data$kills_log[[i]]$time
    time_diff <- c(0, diff(time_values))
    median_free_time <- median(time_diff, na.rm = TRUE)
  }
  
  median_free_times <- c(median_free_times, median_free_time)
}

mean_median_free_time <- mean(median_free_times, na.rm = TRUE)

median_free_times[is.na(median_free_times)] <- mean_median_free_time
dota2_data$median_free_time <- median_free_times
print(median_free_time)
```

Q7
```{r q7}

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ JSON-—Ñ–∞–π–ª–∞
level_exp <- fromJSON("C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\level_exp.json")

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π exp –∏ —É–¥–∞–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π level
dota2_data <- dota2_data %>%
  mutate(exp = level_exp[as.character(level)]) %>%
  select(-level)

# –£–¥–∞–ª–µ–Ω–∏–µ –º–∞—Ç—á–µ–π —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π lane
dota2_data <- dota2_data %>%
  group_by(match_id) %>%
  filter(!any(is.na(lane))) %>%
  ungroup()

# –°–æ–∑–¥–∞–Ω–∏–µ –±–∏–Ω–∞—Ä–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑ lane, primary_attr –∏ attack_type, –∏ —É–¥–∞–ª–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
dota2_data <- dota2_data %>%
  mutate(
    lane_1 = ifelse(lane == 1, 1, 0),
    lane_2 = ifelse(lane == 2, 1, 0),
    lane_3 = ifelse(lane == 3, 1, 0),
    str_attr = ifelse(primary_attr == "str", 1, 0),
    agi_attr = ifelse(primary_attr == "agi", 1, 0),
    int_attr = ifelse(primary_attr == "int", 1, 0),
    all_attr = ifelse(primary_attr == "all", 1, 0),
    melee_attack = ifelse(attack_type == "Melee", 1, 0),
    ranged_attack = ifelse(attack_type == "Ranged", 1, 0)
  ) %>%
  select(-lane, -primary_attr, -attack_type)
```

Q8
```{r q8}
# –ó–∞–º–µ–Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–π teamfight_participation > 1 –Ω–∞ 1
dota2_data <- dota2_data %>%
  mutate(teamfight_participation = ifelse(teamfight_participation > 1, 1, teamfight_participation))

# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è teamfight_participation
mean_teamfight_participation <- mean(data$teamfight_participation, na.rm = TRUE)

# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –º–µ–¥–∏–∞–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è teamfight_participation
median_teamfight_participation <- median(data$teamfight_participation, na.rm = TRUE)

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
print(paste(mean_teamfight_participation))
print(paste(median_teamfight_participation))

# –í—ã–±–æ—Ä –º–µ—Ä—ã —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏
if (mean_teamfight_participation < median_teamfight_participation) {
  print("–ú–µ–¥–∏–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤–æ –∫ –≤—ã–±—Ä–æ—Å–∞–º –∏ –ª—É—á—à–µ –æ—Ç—Ä–∞–∂–∞–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—É—é —Ç–µ–Ω–¥–µ–Ω—Ü–∏—é, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ —Å–ª—É—á–∞—è—Ö, –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è. –°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∏–ª—å–Ω–æ –∏—Å–∫–∞–∂–µ–Ω–æ –≤—ã–±—Ä–æ—Å–∞–º–∏, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –º–µ–¥–∏–∞–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –Ω–∞–ª–∏—á–∏—è –≤—ã–±—Ä–æ—Å–æ–≤.")
} else {
  print("–°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ, –µ—Å–ª–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –∏–º–µ–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö –≤—ã–±—Ä–æ—Å–æ–≤.")
}

dota2_data$last_hits<- dota2_data$neutral_kills + dota2_data$lane_kills
nonancient_kills <- dota2_data$neutral_kills - dota2_data$ancient_kills
dota2_data$nonancient_kills <- nonancient_kills
dota2_data$neutral_kills = NULL

dota2_data$healing_zero <- ifelse(dota2_data$hero_healing == 0, 1, 0)
dota2_data$exp_zero <- ifesle(dota2_data$exp == 0, 1, 0)
```

Q9.1
```{r q9.1}
cor.test(dota2_data$kills, dota2_data$gold_per_min)
```

–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –∑–Ω–∞—á–∏–º–∞. –ó–Ω–∞—á–µ–Ω–∏–µ p-value —Ä–∞–≤–Ω–æ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ 0.

Q9.2

```{r q9.2}
e = 2.7182818284
xyi <- log(1 + dota2_data$kills, e)
cor.test(xyi, dota2_data$gold_per_min)
```

–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —É–º–µ–Ω—å—à–∏–ª–∞—Å—å –Ω–∞ –æ–¥–Ω—É —Å–æ—Ç—É—é, –Ω–æ –æ—Å—Ç–∞–ª–∞—Å—å –≤—Å–µ —Ç–∞–∫–∂–µ –∑–Ω–∞—á–∏–º–æ–π

Q10
```{r q10.1}
# –í—ã–±–æ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
variables <- c("kills", "deaths", "assists", "gold_per_min")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º –∏ Q-Q –≥—Ä–∞—Ñ–∏–∫–æ–≤
for (var in variables) {
  p1 <- ggplot(dota2_data, aes(x = !!sym(var))) + 
    geom_histogram(bins = 30, fill = "blue", alpha = 0.7) +
    ggtitle(paste("Histogram of", var))
  
  p2 <- ggplot(dota2_data, aes(sample = !!sym(var))) + 
    stat_qq() + 
    stat_qq_line() +
    ggtitle(paste("Q-Q Plot of", var))
  
  print(p1)
  print(p2)
}

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å –ø–æ–º–æ—â—å—é —Ç–µ—Å—Ç–∞ –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞
shapiro_test <- function(x) {
  if (length(x) > 5000) {
    x <- sample(x, 5000)
  }
  shapiro.test(x)$p.value
}

shapiro_results <- sapply(dota2_data[variables], shapiro_test)
shapiro_results
```
–û—Ç–≤–µ—Ç –Ω–∞ Q10.1
–ò—Å—Ö–æ–¥—è –∏–∑ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π –∏ p-–∑–Ω–∞—á–µ–Ω–∏–π —Ç–µ—Å—Ç–∞, –¥–µ–ª–∞–µ–º –≤—ã–≤–æ–¥ –æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö. –ï—Å–ª–∏ p-–∑–Ω–∞—á–µ–Ω–∏–µ –º–µ–Ω—å—à–µ 0.05, —Ç–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è –æ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ.

```{r q10.2}
# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–π –∏ –∫–æ—Ä–Ω–µ–≤—ã—Ö —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π
log_transformed <- dota2_data %>%
  mutate(across(all_of(variables), ~log1p(.)))

sqrt_transformed <- dota2_data %>%
  mutate(across(all_of(variables), ~sqrt(.)))

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π
log_shapiro_results <- sapply(log_transformed[variables], shapiro_test)
sqrt_shapiro_results <- sapply(sqrt_transformed[variables], shapiro_test)

log_shapiro_results
sqrt_shapiro_results

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º –∏ Q-Q –≥—Ä–∞—Ñ–∏–∫–æ–≤ –ø–æ—Å–ª–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π
for (var in variables) {
  p1 <- ggplot(log_transformed, aes(x = !!sym(var))) + 
    geom_histogram(bins = 30, fill = "green", alpha = 0.7)
  
  p2 <- ggplot(log_transformed, aes(sample = !!sym(var))) + 
    stat_qq() + 
    stat_qq_line()
  
  print(p1)
  print(p2)
  
  p3 <- ggplot(sqrt_transformed, aes(x = !!sym(var))) + 
    geom_histogram(bins = 30, fill = "red", alpha = 0.7)
  
  p4 <- ggplot(sqrt_transformed, aes(sample = !!sym(var))) + 
    stat_qq() + 
    stat_qq_line()
  
  print(p3)
  print(p4)
}

```

–û—Ç–≤–µ—Ç –Ω–∞ Q10.2
–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–π –∏ –∫–æ—Ä–Ω–µ–≤—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π, –º–æ–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å p-–∑–Ω–∞—á–µ–Ω–∏—è —Ç–µ—Å—Ç–∞ –¥–æ –∏ –ø–æ—Å–ª–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π. –ï—Å–ª–∏ p-–∑–Ω–∞—á–µ–Ω–∏—è —É–≤–µ–ª–∏—á–∏–ª–∏—Å—å –∏ —Å—Ç–∞–ª–∏ –±–æ–ª—å—à–µ 0.05, —Ç–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞–ª–æ –±–ª–∏–∂–µ –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É.

Q11.1

```{r q11.1}
# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è gold_per_min
ggplot(dota2_data, aes(x = gold_per_min)) + 
  geom_density(fill = "blue", alpha = 0.5) +
  ggtitle("–∞–±–æ–±1")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è gold_per_min –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º
potential_vars <- c("hero_id", "lane_1", "lane_2", "lane_3", "str_attr", "agi_attr", "int_attr", "melee_attack", "ranged_attack")

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–æ—Ç–Ω–æ—Å—Ç–µ–π –ø–æ –≥—Ä—É–ø–ø–∞–º
plot_density_by_group <- function(data, var, target) {
  p <- ggplot(data, aes_string(x = target, color = var)) + 
    geom_density(alpha = 0.5)
  print(p)
}

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º
for (var in potential_vars) {
  plot_density_by_group(dota2_data, var, "gold_per_min")
}
```

–ü–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏, –≤–∏–¥–Ω–æ, —á—Ç–æ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –ø–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º lane_1, lane_2, –∏ lane_3 –Ω–µ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –±–∏–º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ gold_per_min. –≠—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –¥—Ä—É–≥–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Ç–∞–∫–∏–µ –∫–∞–∫ hero_id –∏–ª–∏ –¥—Ä—É–≥–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –≥–µ—Ä–æ–µ–≤, –º–æ–≥—É—Ç –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤–ª–∏—è—Ç—å –Ω–∞ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –±–∏–º–æ–¥–∞–ª—å–Ω–æ—Å—Ç–∏.



Q11.2

```{r q11.2}
# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è last_hits
ggplot(dota2_data, aes(x = last_hits)) + 
  geom_density(fill = "blue", alpha = 0.5)
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è last_hits –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º
# –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ –∂–µ potential_vars, —á—Ç–æ –∏ –≤ Q11.1
# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º –¥–ª—è last_hits
for (var in potential_vars) {
  plot_density_by_group(dota2_data, var, "last_hits")
}
```

–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ,—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–ø–æ–ø–µ—Ä–µ–º–µ–Ω–Ω–æ–πlane_1–Ω–µ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –±–∏–º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—èlast_hits. –≠—Ç–æ —Ç–∞–∫–∂–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ –¥—Ä—É–≥–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Ç–∞–∫–∏–µ –∫–∞–∫ hero_id–∏–¥—Ä—É–≥–∏–µ—Å–≤–æ–π—Å—Ç–≤–∞–≥–µ—Ä–æ—è,–º–æ–≥—É—Ç –±—ã—Ç—å –±–æ–ª–µ–µ –ø–æ–ª–µ–∑–Ω—ã–º–∏ –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –±–∏–º–æ–¥–∞–ª—å–Ω–æ—Å—Ç–∏.

 Q12.1, Q12.2 –∏ Q12.3

```{r q12}
dota2_data <- read.csv("C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\dota2_proleague.csv")
dota2_data <- dota2_data %>%
  select(-c(X, player_slot, account_id, additional_units, patch, region, lose, radiant_win))
dota2_data <- dota2_data %>%
  filter(game_mode == 2) %>%
  na.omit()
heroes_data <- read.csv("C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\heroes.csv")
heroes_data <- heroes_data %>%
  rename(hero_id = id)
dota2_data <- dota2_data %>%
  left_join(heroes_data, by = "hero_id")
dota2_data <- dota2_data %>%
  mutate(
    kda_ratio = ifelse(deaths == 0, kills + assists, (kills + assists) / deaths),
    exp = case_when(
      level == 1 ~ 0,
      level == 2 ~ 240,
      level == 3 ~ 640,
      level == 4 ~ 1160,
      level == 5 ~ 1760,
      level == 6 ~ 2440,
      level == 7 ~ 3200,
      level == 8 ~ 4000,
      level == 9 ~ 4900,
      level == 10 ~ 5900,
      level == 11 ~ 7000,
      level == 12 ~ 8200,
      level == 13 ~ 9500,
      level == 14 ~ 10900,
      level == 15 ~ 12400,
      level == 16 ~ 14000,
      level == 17 ~ 15700,
      level == 18 ~ 17500,
      level == 19 ~ 19400,
      level == 20 ~ 21400,
      level == 21 ~ 23600,
      level == 22 ~ 26000,
      level == 23 ~ 28600,
      level == 24 ~ 31400,
      level == 25 ~ 34400,
      level == 26 ~ 38400,
      level == 27 ~ 43400,
      level == 28 ~ 49400,
      level == 29 ~ 56400,
      level == 30 ~ 63900
    )
  )


correlations <- cor(dota2_data[, c("gold_per_min", "last_hits", "kills", "exp")], use = "complete.obs")
top_correlations <- correlations["gold_per_min", ][-1]
top_3_vars <- sort(top_correlations, decreasing = TRUE)[1:3]
cat("Q12.1: –¢—Ä–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å –Ω–∞–∏–±–æ–ª—å—à–µ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π —Å gold_per_min: ", paste(names(top_3_vars), collapse = ", "), "\n")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π
p_values <- sapply(names(top_3_vars), function(var) {
  cor.test(dota2_data$gold_per_min, dota2_data[[var]])$p.value
})
cat("Q12.2: p-values –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö: ", paste(p_values, collapse = ", "), "\n")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
cor_matrix <- cor(dota2_data[, names(top_3_vars)], use = "complete.obs")
cat("Q12.3: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É —Ç–æ–ø-3 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏: \n")
print(cor_matrix)
```

Q12.1
–ù–∞–∏–±–æ–ª—å—à—É—é –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é —Å –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º gold_per_min –∏–º–µ—é—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

last_hits (0.7529873)

kills (0.4255873)

exp (0.5713789)

–≠—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–º–µ—é—Ç —Å–∞–º—ã–µ –≤—ã—Å–æ–∫–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å gold_per_min.

Q12.2 
last_hits: p-value = 0

kills: p-value = 0

exp: p-value = 0

–í—Å–µ —Ç—Ä–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–º–µ—é—Ç p-value, —Ä–∞–≤–Ω–æ–µ 0, —á—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –º–µ–Ω—å—à–µ —É—Ä–æ–≤–Ω—è –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ Œ±=0.05. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—Å–µ —Ç—Ä–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —è–≤–ª—è—é—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–º–∏, –∏ –º—ã –º–æ–∂–µ–º —Å –≤—ã—Å–æ–∫–æ–π —Å—Ç–µ–ø–µ–Ω—å—é —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ —É—Ç–≤–µ—Ä–∂–¥–∞—Ç—å, —á—Ç–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Å–≤—è–∑—å –º–µ–∂–¥—É —ç—Ç–∏–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∏ gold_per_min.

Q12.3: –û–±–Ω–∞—Ä—É–∂–∏–ª–∏ –ª–∏ –≤—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –∫–∞–∫–∏–º–∏-–ª–∏–±–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∏–∑ —ç—Ç–æ–≥–æ —Ç–æ–ø–∞? –ï—Å–ª–∏ –¥–∞, –∫–∞–∫ –≤—ã –¥—É–º–∞–µ—Ç–µ, —Å —á–µ–º —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ?
–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É —Ç–æ–ø-3 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:

–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É last_hits –∏ kills: 0.4255873

–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É last_hits –∏ exp: 0.7529873

–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É kills –∏ exp: 0.5713789

–í—Å–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É —Ç–æ–ø-3 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —è–≤–ª—è—é—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–º–∏ (p-value < 0.05). –í—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É —ç—Ç–∏–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –æ–±—ä—è—Å–Ω–µ–Ω—ã —Ç–µ–º, —á—Ç–æ –æ–Ω–∏ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∞–Ω—ã –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∏–≥—Ä—ã:

last_hits –∏ exp: –í—ã—Å–æ–∫–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É last_hits –∏ exp –æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ —É–±–∏–π—Å—Ç–≤–∞ –∫—Ä–∏–ø–æ–≤ (last_hits) –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤–ª–∏—è—é—Ç –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –æ–ø—ã—Ç–∞ (exp). –ß–µ–º –±–æ–ª—å—à–µ –∫—Ä–∏–ø–æ–≤ –∏–≥—Ä–æ–∫ —É–±–∏–≤–∞–µ—Ç, —Ç–µ–º –±–æ–ª—å—à–µ –æ–ø—ã—Ç–∞ –æ–Ω –ø–æ–ª—É—á–∞–µ—Ç.

kills –∏ exp: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É kills –∏ exp –æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ —É–±–∏–π—Å—Ç–≤–æ –≤—Ä–∞–∂–µ—Å–∫–∏—Ö –≥–µ—Ä–æ–µ–≤ —Ç–∞–∫–∂–µ –ø—Ä–∏–Ω–æ—Å–∏—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø—ã—Ç–∞.

last_hits –∏ kills: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É last_hits –∏ kills –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–∞ —Å —Ç–µ–º, —á—Ç–æ –∏–≥—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –∞–∫—Ç–∏–≤–Ω–æ –¥–æ–±–∏–≤–∞—é—Ç –∫—Ä–∏–ø–æ–≤, —á–∞—Å—Ç–æ —É—á–∞—Å—Ç–≤—É—é—Ç –∏ –≤ —É–±–∏–π—Å—Ç–≤–∞—Ö –≤—Ä–∞–∂–µ—Å–∫–∏—Ö –≥–µ—Ä–æ–µ–≤, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —É–≤–µ–ª–∏—á–µ–Ω–∏—é –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è kills.

Q13

``` {r q13}
dota2_data <- read.csv("C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\dota2_proleague.csv")
level_exp <- fromJSON("C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\level_exp.json")
level_exp_df <- data.frame(level = as.numeric(names(level_exp)), exp = unlist(level_exp))
dota2_data <- dota2_data %>%
  left_join(level_exp_df, by = c("level" = "level")) %>%
  select(-level)
dota2_data <- dota2_data %>%
  mutate(
    lane_1 = ifelse(lane == 1, 1, 0),
    lane_2 = ifelse(lane == 2, 1, 0),
    lane_3 = ifelse(lane == 3, 1, 0)
  ) %>%
  select(-lane)

central_lane_data <- dota2_data %>% filter(lane_2 == 1)

side_lane_data <- dota2_data %>% filter(lane_2 == 0)

# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –∏ –∏—Ö –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –¥–ª—è central_lane_data
central_correlations <- cor(central_lane_data %>% select(gold_per_min, last_hits, kills, exp), use = "complete.obs")

central_p_values <- sapply(names(central_correlations)[-1], function(var) {
  cor_test <- cor.test(central_lane_data[[var]], central_lane_data$gold_per_min)
  return(c(cor = cor_test$estimate, p.value = cor_test$p.value))
})

# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –∏ –∏—Ö –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –¥–ª—è side_lane_data
side_correlations <- cor(side_lane_data %>% select(gold_per_min, last_hits, kills, exp), use = "complete.obs")

side_p_values <- sapply(names(side_correlations)[-1], function(var) {
  cor_test <- cor.test(side_lane_data[[var]], side_lane_data$gold_per_min)
  return(c(cor = cor_test$estimate, p.value = cor_test$p.value))
})

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏
cat("–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏ (lane_2 = 1):\n")
print(central_correlations)
cat("\nP-values –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏ (lane_2 = 1):\n")
print(central_p_values)

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è –±–æ–∫–æ–≤—ã—Ö –ª–∏–Ω–∏–π
cat("–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –±–æ–∫–æ–≤—ã—Ö –ª–∏–Ω–∏–π (lane_2 = 0):\n")
print(side_correlations)
cat("\nP-values –¥–ª—è –±–æ–∫–æ–≤—ã—Ö –ª–∏–Ω–∏–π (lane_2 = 0):\n")
print(side_p_values)


```
Q13.1

–ù–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏ (lane_2 = 1) –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å –Ω–∞–∏–±–æ–ª—å—à–µ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π —Å gold_per_min:

kills (–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è 0.6941594)
exp (–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è 0.6743608)
last_hits (–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è 0.6309236)
–ó–Ω–∞—á–∏–º–æ—Å—Ç–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π (p-values):

–î–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏:

kills: p-value < 2.2e-16
exp: p-value < 2.2e-16
last_hits: p-value < 2.2e-16

Q13.2

–ù–∞ –±–æ–∫–æ–≤—ã—Ö –ª–∏–Ω–∏—è—Ö (lane_2 = 0) –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å –Ω–∞–∏–±–æ–ª—å—à–µ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π —Å gold_per_min:

last_hits (–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è 0.8439113)
exp (–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è 0.6791351)
kills (–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è 0.6779185)
–ó–Ω–∞—á–∏–º–æ—Å—Ç–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π (p-values):

–î–ª—è –±–æ–∫–æ–≤—ã—Ö –ª–∏–Ω–∏–π:

last_hits: p-value < 2.2e-16
exp: p-value < 2.2e-16
kills: p-value < 2.2e-16

Q13.3

–î–∞, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–ª–∏—á–∞—é—Ç—Å—è. –î–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏ kills –∏ exp –∏–º–µ—é—Ç –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å gold_per_min, —á–µ–º last_hits, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –Ω–∞ –±–æ–∫–æ–≤—ã—Ö –ª–∏–Ω–∏—è—Ö last_hits –∏–º–µ–µ—Ç –Ω–∞–∏–±–æ–ª—å—à—É—é –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é —Å gold_per_min.
–†–∞–∑–ª–∏—á–∏—è –º–æ–≥—É—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω—ã —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ä–æ–ª—è–º–∏ –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏ –∏–≥—Ä—ã –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –∏ –±–æ–∫–æ–≤—ã—Ö –ª–∏–Ω–∏—è—Ö. –ì–µ—Ä–æ–∏ –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏ —á–∞—Å—Ç–æ –∏–≥—Ä–∞—é—Ç –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–µ–µ –∏ –ø–æ–ª—É—á–∞—é—Ç –∑–æ–ª–æ—Ç–æ —á–µ—Ä–µ–∑ —É–±–∏–π—Å—Ç–≤–∞ –∏ —É—á–∞—Å—Ç–∏–µ –≤ —Å—Ä–∞–∂–µ–Ω–∏—è—Ö, —Ç–æ–≥–¥–∞ –∫–∞–∫ –≥–µ—Ä–æ–∏ –Ω–∞ –±–æ–∫–æ–≤—ã—Ö –ª–∏–Ω–∏—è—Ö –±–æ–ª—å—à–µ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω—ã –Ω–∞ —Ñ–∞—Ä–º–µ –∫—Ä–∏–ø–æ–≤.

Q 14

``` {r q14}
dota2_data <- read.csv("C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\dota2_proleague.csv")
dota2_data <- dota2_data %>%
  select(-c(X, player_slot, account_id, additional_units, patch, region, lose, radiant_win))
dota2_data <- dota2_data %>%
  filter(game_mode == 2) %>%
  na.omit()
heroes_data <- read.csv("C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\heroes.csv")
heroes_data <- heroes_data %>%
  rename(hero_id = id)
dota2_data <- dota2_data %>%
  left_join(heroes_data, by = "hero_id")
dota2_data <- dota2_data %>%
  mutate(
    kda_ratio = ifelse(deaths == 0, kills + assists, (kills + assists) / deaths),
    exp = case_when(
      level == 1 ~ 0,
      level == 2 ~ 240,
      level == 3 ~ 640,
      level == 4 ~ 1160,
      level == 5 ~ 1760,
      level == 6 ~ 2440,
      level == 7 ~ 3200,
      level == 8 ~ 4000,
      level == 9 ~ 4900,
      level == 10 ~ 5900,
      level == 11 ~ 7000,
      level == 12 ~ 8200,
      level == 13 ~ 9500,
      level == 14 ~ 10900,
      level == 15 ~ 12400,
      level == 16 ~ 14000,
      level == 17 ~ 15700,
      level == 18 ~ 17500,
      level == 19 ~ 19400,
      level == 20 ~ 21400,
      level == 21 ~ 23600,
      level == 22 ~ 26000,
      level == 23 ~ 28600,
      level == 24 ~ 31400,
      level == 25 ~ 34400,
      level == 26 ~ 38400,
      level == 27 ~ 43400,
      level == 28 ~ 49400,
      level == 29 ~ 56400,
      level == 30 ~ 63900
    ),
    start_time_unix = as.numeric(as.POSIXct(start_time, format="%Y-%m-%d %H:%M:%S", tz="UTC"))
  )
dota2_data <- dota2_data %>% select(-kills_log)
dota2_data <- dota2_data %>%
  mutate(kda_ratio = ifelse(deaths == 0, kills + assists, (kills + assists) / deaths)) %>%
  select(-kda)

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –∏ p-value
get_correlations <- function(data) {
  corr_matrix <- cor(data %>% select(gold_per_min, assists, deaths, kills, last_hits, obs_placed, kda_ratio, exp, hero_healing), use = "complete.obs")
  p_values <- sapply(names(corr_matrix["gold_per_min", -1]), function(x) cor.test(data$gold_per_min, data[[x]])$p.value)
  list(correlation = corr_matrix["gold_per_min", -1], p_value = p_values)
}

# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –ø–æ–¥–≥—Ä—É–ø–ø—ã –ø–æ –º–µ–¥–∏–∞–Ω–µ teamfight_participation
median_teamfight <- median(dota2_data$teamfight_participation, na.rm = TRUE)
low_teamfight_data <- dota2_data %>% filter(teamfight_participation < median_teamfight)
high_teamfight_data <- dota2_data %>% filter(teamfight_participation >= median_teamfight)
```


``` {r q14.1}
# Q14.1: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –≥—Ä—É–ø–ø—ã —Å teamfight_participation < –º–µ–¥–∏–∞–Ω—ã
low_teamfight_correlations <- get_correlations(low_teamfight_data)
low_teamfight_top_correlations <- sort(low_teamfight_correlations$correlation, decreasing = TRUE)[1:3]
low_teamfight_top_correlations_pvalues <- low_teamfight_correlations$p_value[names(low_teamfight_top_correlations)]

# Q14.2: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –≥—Ä—É–ø–ø—ã —Å teamfight_participation >= –º–µ–¥–∏–∞–Ω—ã
high_teamfight_correlations <- get_correlations(high_teamfight_data)
high_teamfight_top_correlations <- sort(high_teamfight_correlations$correlation, decreasing = TRUE)[1:3]
high_teamfight_top_correlations_pvalues <- high_teamfight_correlations$p_value[names(high_teamfight_top_correlations)]

```


``` {r q14.2}
# Q14.3: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏
# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
cat("Q14.1: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –≥—Ä—É–ø–ø—ã —Å teamfight_participation < –º–µ–¥–∏–∞–Ω—ã\n")
print(low_teamfight_top_correlations)
print(low_teamfight_top_correlations_pvalues)
```

–ù–∞–∏–±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π gold_per_min —É –≥–µ—Ä–æ–µ–≤ —Å –Ω–∏–∑–∫–∏–º —É—á–∞—Å—Ç–∏–µ–º –≤ –∫–æ–º–∞–Ω–¥–Ω—ã—Ö –±–æ—è—Ö (teamfight_participation < –º–µ–¥–∏–∞–Ω—ã) –Ω–∞–±–ª—é–¥–∞—é—Ç—Å—è –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:

last_hits: 0.8412053
exp: 0.6919248
kills: 0.6426595

–ó–Ω–∞—á–µ–Ω–∏—è p-value –¥–ª—è —ç—Ç–∏—Ö –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π —Ä–∞–≤–Ω—ã 0, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∏—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫—É—é –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –ø—Ä–∏ —É—Ä–æ–≤–Ω–µ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ Œ± = 0.05. –≠—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–±–∏—Ç—ã—Ö –∫—Ä–∏–ø–æ–≤ (last_hits), –æ–ø—ã—Ç (exp) –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–±–∏–π—Å—Ç–≤ (kills) –≤–Ω–æ—Å—è—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –≤–∫–ª–∞–¥ –≤ —É—Ä–æ–≤–µ–Ω—å –∑–∞—Ä–∞–±–æ—Ç–∫–∞ –∑–æ–ª–æ—Ç–∞ –≤ –º–∏–Ω—É—Ç—É (gold_per_min) –¥–ª—è –≥–µ—Ä–æ–µ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–µ–Ω–µ–µ –∞–∫—Ç–∏–≤–Ω–æ —É—á–∞—Å—Ç–≤—É—é—Ç –≤ –∫–æ–º–∞–Ω–¥–Ω—ã—Ö –±–æ—è—Ö.

``` {r q14.3}
cat("\nQ14.2: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –≥—Ä—É–ø–ø—ã —Å teamfight_participation >= –º–µ–¥–∏–∞–Ω—ã\n")
print(high_teamfight_top_correlations)
print(high_teamfight_top_correlations_pvalues)
```

–î–ª—è –≥–µ—Ä–æ–µ–≤ —Å –≤—ã—Å–æ–∫–∏–º —É—á–∞—Å—Ç–∏–µ–º –≤ –∫–æ–º–∞–Ω–¥–Ω—ã—Ö –±–æ—è—Ö (teamfight_participation >= –º–µ–¥–∏–∞–Ω—ã), –Ω–∞–∏–±–æ–ª—å—à–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π gold_per_min –Ω–∞–±–ª—é–¥–∞—é—Ç—Å—è –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:

last_hits: 0.8100713
kills: 0.7358739
exp: 0.6767167

–ó–Ω–∞—á–µ–Ω–∏—è p-value –¥–ª—è —ç—Ç–∏—Ö –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π —Ç–∞–∫–∂–µ —Ä–∞–≤–Ω—ã 0, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∏—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫—É—é –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –ø—Ä–∏ —É—Ä–æ–≤–Ω–µ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ Œ± = 0.05. –≠—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–±–∏—Ç—ã—Ö –∫—Ä–∏–ø–æ–≤ (last_hits), –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–±–∏–π—Å—Ç–≤ (kills) –∏ –æ–ø—ã—Ç (exp) –≤–Ω–æ—Å—è—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –≤–∫–ª–∞–¥ –≤ —É—Ä–æ–≤–µ–Ω—å –∑–∞—Ä–∞–±–æ—Ç–∫–∞ –∑–æ–ª–æ—Ç–∞ –≤ –º–∏–Ω—É—Ç—É (gold_per_min) –¥–ª—è –≥–µ—Ä–æ–µ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±–æ–ª–µ–µ –∞–∫—Ç–∏–≤–Ω–æ —É—á–∞—Å—Ç–≤—É—é—Ç –≤ –∫–æ–º–∞–Ω–¥–Ω—ã—Ö –±–æ—è—Ö.

``` {r q14.4}
cat("\nQ14.3: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏\n")
cat("–ì—Ä—É–ø–ø–∞ —Å –Ω–∏–∑–∫–æ–π teamfight_participation:\n")
print(low_teamfight_top_correlations)
cat("–ì—Ä—É–ø–ø–∞ —Å –≤—ã—Å–æ–∫–æ–π teamfight_participation:\n")
print(high_teamfight_top_correlations)
```
–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è:

–ì—Ä—É–ø–ø–∞ —Å –Ω–∏–∑–∫–æ–π teamfight_participation:

last_hits: 0.8412053
exp: 0.6919248
kills: 0.6426595
–ì—Ä—É–ø–ø–∞ —Å –≤—ã—Å–æ–∫–æ–π teamfight_participation:

last_hits: 0.8100713
kills: 0.7358739
exp: 0.6767167

–í –æ–±–µ–∏—Ö –≥—Ä—É–ø–ø–∞—Ö –Ω–∞–∏–±–æ–ª—å—à—É—é –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é —Å gold_per_min –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è last_hits (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–±–∏—Ç—ã—Ö –∫—Ä–∏–ø–æ–≤). –≠—Ç–æ –æ–∂–∏–¥–∞–µ–º–æ, —Ç–∞–∫ –∫–∞–∫ –¥–æ–±–∏–≤–∞–Ω–∏–µ –∫—Ä–∏–ø–æ–≤ —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∑–æ–ª–æ—Ç–∞ –≤ –∏–≥—Ä–µ.
–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ exp (–æ–ø—ã—Ç) –∏ kills (—É–±–∏–π—Å—Ç–≤–∞) —Ç–∞–∫–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –≤—ã—Å–æ–∫–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å gold_per_min –≤ –æ–±–µ–∏—Ö –≥—Ä—É–ø–ø–∞—Ö, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å —ç—Ç–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–æ–ª–æ—Ç–∞.


–†–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏:

–í –≥—Ä—É–ø–ø–µ —Å –Ω–∏–∑–∫–∏–º —É—á–∞—Å—Ç–∏–µ–º –≤ –∫–æ–º–∞–Ω–¥–Ω—ã—Ö –±–æ—è—Ö (teamfight_participation < –º–µ–¥–∏–∞–Ω—ã) –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è last_hits –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–æ–ª–µ–µ –≤—ã—Å–æ–∫—É—é –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é —Å gold_per_min (0.8412053) –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –≥—Ä—É–ø–ø–æ–π —Å –≤—ã—Å–æ–∫–∏–º —É—á–∞—Å—Ç–∏–µ–º –≤ –∫–æ–º–∞–Ω–¥–Ω—ã—Ö –±–æ—è—Ö (0.8100713). –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ –≥–µ—Ä–æ–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–µ–Ω–µ–µ –∞–∫—Ç–∏–≤–Ω–æ —É—á–∞—Å—Ç–≤—É—é—Ç –≤ –∫–æ–º–∞–Ω–¥–Ω—ã—Ö –±–æ—è—Ö, –±–æ–ª—å—à–µ —Ñ–æ–∫—É—Å–∏—Ä—É—é—Ç—Å—è –Ω–∞ —Ñ–∞—Ä–º–µ –∫—Ä–∏–ø–æ–≤ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–æ–ª–æ—Ç–∞.

–í –≥—Ä—É–ø–ø–µ —Å –≤—ã—Å–æ–∫–∏–º —É—á–∞—Å—Ç–∏–µ–º –≤ –∫–æ–º–∞–Ω–¥–Ω—ã—Ö –±–æ—è—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è kills –∏–º–µ–µ—Ç –±–æ–ª–µ–µ –≤—ã—Å–æ–∫—É—é –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é —Å gold_per_min (0.7358739) –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –≥—Ä—É–ø–ø–æ–π —Å –Ω–∏–∑–∫–∏–º —É—á–∞—Å—Ç–∏–µ–º (0.6426595). –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ –≥–µ—Ä–æ–∏, –∫–æ—Ç–æ—Ä—ã–µ –±–æ–ª—å—à–µ —É—á–∞—Å—Ç–≤—É—é—Ç –≤ –∫–æ–º–∞–Ω–¥–Ω—ã—Ö –±–æ—è—Ö, –ø–æ–ª—É—á–∞—é—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—É—é —á–∞—Å—Ç—å —Å–≤–æ–µ–≥–æ –∑–æ–ª–æ—Ç–∞ –∑–∞ —Å—á–µ—Ç —É–±–∏–π—Å—Ç–≤ –≤—Ä–∞–≥–æ–≤.

``` {r q14.5}
healing_group <- dota2_data %>% filter(hero_healing > 0)
non_healing_group <- dota2_data %>% filter(hero_healing == 0)

t_test_healing <- t.test(healing_group$gold_per_min, non_healing_group$gold_per_min)
```

Q15

``` {r q15}
# Q15.1: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –±–ª–∏–∂–Ω–µ–≥–æ —Ç–∏–ø–∞ –∞—Ç–∞–∫–∏
melee_top_correlations <- sort(melee_correlations$correlation, decreasing = TRUE)[1:3]
melee_top_correlations_pvalues <- melee_correlations$p_value[names(melee_top_correlations)]

# Q15.2: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–≥–æ —Ç–∏–ø–∞ –∞—Ç–∞–∫–∏
ranged_top_correlations <- sort(ranged_correlations$correlation, decreasing = TRUE)[1:3]
ranged_top_correlations_pvalues <- ranged_correlations$p_value[names(ranged_top_correlations)]

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
cat("Q15.1: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –±–ª–∏–∂–Ω–µ–≥–æ —Ç–∏–ø–∞ –∞—Ç–∞–∫–∏\n")
print(melee_top_correlations)
print(melee_top_correlations_pvalues)

cat("\nQ15.2: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–≥–æ —Ç–∏–ø–∞ –∞—Ç–∞–∫–∏\n")
print(ranged_top_correlations)
print(ranged_top_correlations_pvalues)

# Q15.3: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
cat("\nQ15.3: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏\n")
cat("–ë–ª–∏–∂–Ω–∏–π —Ç–∏–ø –∞—Ç–∞–∫–∏:\n")
print(melee_top_correlations)
cat("–î–∞–ª—å–Ω–∏–π —Ç–∏–ø –∞—Ç–∞–∫–∏:\n")
print(ranged_top_correlations)

```

Q15.1

–¢—Ä–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –ª—É—á—à–µ –≤—Å–µ–≥–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—Ç —Å `gold_per_min` –¥–ª—è –≥–µ—Ä–æ–µ–≤ —Å –±–ª–∏–∂–Ω–∏–º —Ç–∏–ø–æ–º –∞—Ç–∞–∫–∏, —ç—Ç–æ:

1. `last_hits` (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ \( r = 0.776 \), \( p \)-–∑–Ω–∞—á–µ–Ω–∏–µ < 0.001)

2. `kills` (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ \( r = 0.666 \), \( p \)-–∑–Ω–∞—á–µ–Ω–∏–µ < 0.001)

3. `exp` (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ \( r = 0.664 \), \( p \)-–∑–Ω–∞—á–µ–Ω–∏–µ < 0.001)



Q15.2

–¢—Ä–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –ª—É—á—à–µ –≤—Å–µ–≥–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—Ç —Å gold_per_min –¥–ª—è –≥–µ—Ä–æ–µ–≤ —Å –¥–∞–ª—å–Ω–∏–º —Ç–∏–ø–æ–º –∞—Ç–∞–∫–∏, —ç—Ç–æ:

last_hits (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ ùëü = 0.847 p-–∑–Ω–∞—á–µ–Ω–∏–µ < 0.001)

kills (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ ùëü= 0.718 p-–∑–Ω–∞—á–µ–Ω–∏–µ < 0.001)

exp (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ ùëü = 0.692 p-–∑–Ω–∞—á–µ–Ω–∏–µ < 0.001)


Q15.3

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –ø–æ–¥–≥—Ä—É–ø–ø–∞—Ö (–≥–µ—Ä–æ–∏ —Å –±–ª–∏–∂–Ω–∏–º –∏ –¥–∞–ª—å–Ω–∏–º —Ç–∏–ø–∞–º–∏ –∞—Ç–∞–∫–∏) –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ:

–î–ª—è –æ–±–æ–∏—Ö —Ç–∏–ø–æ–≤ –∞—Ç–∞–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ last_hits, kills –∏ exp –Ω–∞–∏–±–æ–ª–µ–µ —Å–∏–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—Ç —Å gold_per_min.

–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –≥–µ—Ä–æ–µ–≤ —Å –¥–∞–ª—å–Ω–∏–º —Ç–∏–ø–æ–º –∞—Ç–∞–∫–∏ –Ω–µ–º–Ω–æ–≥–æ –≤—ã—à–µ, —á–µ–º –¥–ª—è –≥–µ—Ä–æ–µ–≤ —Å –±–ª–∏–∂–Ω–∏–º —Ç–∏–ø–æ–º –∞—Ç–∞–∫–∏.

Q16

``` {r q16.1}
# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏ (lane == 2)
mid_lane_data <- dota2_data %>% filter(lane == 2)

# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –±–ª–∏–∂–Ω–∏–π –∏ –¥–∞–ª—å–Ω–∏–π —Ç–∏–ø—ã –∞—Ç–∞–∫–∏ –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏
mid_melee_data <- mid_lane_data %>% filter(attack_type == "Melee")
mid_ranged_data <- mid_lane_data %>% filter(attack_type == "Ranged")

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –∏ p-value
get_correlations <- function(data) {
  corr_matrix <- cor(data %>% select(gold_per_min, assists, deaths, kills, last_hits, obs_placed, kda_ratio, exp, hero_healing), use = "complete.obs")
  p_values <- sapply(names(corr_matrix["gold_per_min", -1]), function(x) cor.test(data$gold_per_min, data[[x]])$p.value)
  list(correlation = corr_matrix["gold_per_min", -1], p_value = p_values)
}

# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –¥–ª—è –±–ª–∏–∂–Ω–µ–≥–æ —Ç–∏–ø–∞ –∞—Ç–∞–∫–∏ –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏
mid_melee_correlations <- get_correlations(mid_melee_data)

# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –¥–ª—è –¥–∞–ª—å–Ω–µ–≥–æ —Ç–∏–ø–∞ –∞—Ç–∞–∫–∏ –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏
mid_ranged_correlations <- get_correlations(mid_ranged_data)
```

``` {r q16.2}
# Q16.1: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –±–ª–∏–∂–Ω–µ–≥–æ —Ç–∏–ø–∞ –∞—Ç–∞–∫–∏ –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏
mid_melee_top_correlations <- sort(mid_melee_correlations$correlation, decreasing = TRUE)[1:3]
mid_melee_top_correlations_pvalues <- mid_melee_correlations$p_value[names(mid_melee_top_correlations)]

# Q16.2: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–≥–æ —Ç–∏–ø–∞ –∞—Ç–∞–∫–∏ –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏
mid_ranged_top_correlations <- sort(mid_ranged_correlations$correlation, decreasing = TRUE)[1:3]
mid_ranged_top_correlations_pvalues <- mid_ranged_correlations$p_value[names(mid_ranged_top_correlations)]

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏
cat("Q16.1: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –±–ª–∏–∂–Ω–µ–≥–æ —Ç–∏–ø–∞ –∞—Ç–∞–∫–∏ –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏\n")
print(mid_melee_top_correlations)
print(mid_melee_top_correlations_pvalues)

cat("\nQ16.2: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–≥–æ —Ç–∏–ø–∞ –∞—Ç–∞–∫–∏ –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏\n")
print(mid_ranged_top_correlations)
print(mid_ranged_top_correlations_pvalues)

# Q16.3: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏
cat("\nQ16.3: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏\n")
cat("–ë–ª–∏–∂–Ω–∏–π —Ç–∏–ø –∞—Ç–∞–∫–∏:\n")
print(mid_melee_top_correlations)
cat("–î–∞–ª—å–Ω–∏–π —Ç–∏–ø –∞—Ç–∞–∫–∏:\n")
print(mid_ranged_top_correlations)

# Q16.4: –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –Ω–æ–≤—ã—Ö –ø–æ–¥–≥—Ä—É–ø–ø
cat("\nQ16.4: –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –Ω–æ–≤—ã—Ö –ø–æ–¥–≥—Ä—É–ø–ø\n")
cat("–í—ã–±–æ—Ä –ø–æ–¥–≥—Ä—É–ø–ø –≥–µ—Ä–æ–µ–≤, —Å—Ç–æ—è—â–∏—Ö –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏, –æ–±—É—Å–ª–æ–≤–ª–µ–Ω —Ç–µ–º, —á—Ç–æ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è —è–≤–ª—è–µ—Ç—Å—è –∫–ª—é—á–µ–≤–æ–π –ø–æ–∑–∏—Ü–∏–µ–π –≤ –∏–≥—Ä–µ Dota 2. –ì–µ—Ä–æ–∏ –Ω–∞ —ç—Ç–æ–π –ª–∏–Ω–∏–∏ —á–∞—Å—Ç–æ –ø–æ–ª—É—á–∞—é—Ç –±–æ–ª—å—à–µ –æ–ø—ã—Ç–∞ –∏ –∑–æ–ª–æ—Ç–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –∏—Ö –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –∏–≥—Ä–æ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –±–ª–∏–∂–Ω–∏—Ö –∏ –¥–∞–ª—å–Ω–∏—Ö –±–æ–π—Ü–æ–≤ –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏ –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—è–≤–∏—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –∏–≥—Ä–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏ —Å—Ç–∏–ª–∏ –∏–≥—Ä—ã.")
```

Q17

``` {r q17}
dota2_data_path <- "C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\dota2_proleague.csv"
level_exp_path <- "C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\level_exp.json"
heroes_data_path <- "C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\heroes.csv"
dota2_data <- read.csv(dota2_data_path)
heroes_data <- read.csv(heroes_data_path)
level_exp <- fromJSON(level_exp_path)
level_exp_df <- data.frame(level = as.numeric(names(level_exp)), exp = unlist(level_exp))
dota2_data <- dota2_data %>%
  left_join(level_exp_df, by = c("level" = "level"))
dota2_data <- dota2_data %>%
  left_join(heroes_data, by = c("hero_id" = "id"))

# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö isRadiant –∏ radiant_win –≤ —Ñ–∞–∫—Ç–æ—Ä
dota2_data$isRadiant <- as.factor(dota2_data$isRadiant)
dota2_data$radiant_win <- as.factor(ifelse(dota2_data$radiant_win == "True", 1, 0))

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π healing_zero
dota2_data <- dota2_data %>%
  mutate(healing_zero = ifelse(hero_healing == 0, 1, 0))

# –í—ã–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ –ø–æ–±–µ–¥–∞–º –¥–ª—è —Å–≤–µ—Ç–ª–æ–π –∏ —Ç–µ–º–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã
radiant_wins <- dota2_data %>%
  filter(isRadiant == 1) %>%
  summarise(wins = sum(radiant_win == 1) / n())

dire_wins <- dota2_data %>%
  filter(isRadiant == 0) %>%
  summarise(wins = sum(radiant_win == 0) / n())

# –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –¥–≤—É—Ö–≤—ã–±–æ—Ä–æ—á–Ω–æ–≥–æ t-—Ç–µ—Å—Ç–∞
t_test_result <- t.test(as.numeric(dota2_data$radiant_win) ~ dota2_data$isRadiant)

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
cat("p-value –¥–ª—è –≥–∏–ø–æ—Ç–µ–∑—ã –æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø–æ–±–µ–¥—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç–æ—Ä–æ–Ω—ã:", t_test_result$p.value, "\n")
if (t_test_result$p.value < 0.05) {
  cat("H0 –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è: –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ–±–µ–¥—ã –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å—Ç–æ—Ä–æ–Ω—ã.\n")
} else {
  cat("H0 –Ω–µ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è: –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ–±–µ–¥—ã –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å—Ç–æ—Ä–æ–Ω—ã.\n")
}

# –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è gold_per_min
# –ì—Ä—É–ø–ø—ã: melee_attack = 1 vs ranged_attack = 1
melee_vs_ranged <- dota2_data %>%
  filter(attack_type %in% c("Melee", "Ranged")) %>%
  mutate(attack_group = ifelse(attack_type == "Melee", 1, 0))

t_test_melee_ranged <- t.test(gold_per_min ~ attack_group, data = melee_vs_ranged)
cat("p-value –¥–ª—è gold_per_min (melee_attack = 1 vs ranged_attack = 1):", t_test_melee_ranged$p.value, "\n")
if (t_test_melee_ranged$p.value < 0.05) {
  cat("H0 –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è: —Å—Ä–µ–¥–Ω—è—è –≤–µ–ª–∏—á–∏–Ω–∞ gold_per_min –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –º–µ–∂–¥—É melee_attack –∏ ranged_attack.\n")
} else {
  cat("H0 –Ω–µ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è: —Å—Ä–µ–¥–Ω—è—è –≤–µ–ª–∏—á–∏–Ω–∞ gold_per_min –Ω–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –º–µ–∂–¥—É melee_attack –∏ ranged_attack.\n")
}

# –ì—Ä—É–ø–ø—ã: healing_zero = 1 vs healing_zero = 0
healing_zero_groups <- dota2_data %>%
  filter(!is.na(healing_zero))

t_test_healing_zero <- t.test(gold_per_min ~ healing_zero, data = healing_zero_groups)
cat("p-value –¥–ª—è gold_per_min (healing_zero = 1 vs healing_zero = 0):", t_test_healing_zero$p.value, "\n")
if (t_test_healing_zero$p.value < 0.05) {
  cat("H0 –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è: —Å—Ä–µ–¥–Ω—è—è –≤–µ–ª–∏—á–∏–Ω–∞ gold_per_min –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –º–µ–∂–¥—É healing_zero = 1 –∏ healing_zero = 0.\n")
} else {
  cat("H0 –Ω–µ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è: —Å—Ä–µ–¥–Ω—è—è –≤–µ–ª–∏—á–∏–Ω–∞ gold_per_min –Ω–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –º–µ–∂–¥—É healing_zero = 1 –∏ healing_zero = 0.\n")
}


```

Q18
``` {r q18.1}
dota2_data <- read.csv("C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\dota2_proleague.csv")
dota2_data <- dota2_data %>%
  select(-c(X, player_slot, account_id, additional_units, patch, region, lose, radiant_win))
dota2_data <- dota2_data %>%
  filter(game_mode == 2) %>%
  na.omit()
heroes_data <- read.csv("C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\heroes.csv")
heroes_data <- heroes_data %>%
  rename(hero_id = id)
dota2_data <- dota2_data %>%
  left_join(heroes_data, by = "hero_id")
dota2_data <- dota2_data %>%
  mutate(
    kda_ratio = ifelse(deaths == 0, kills + assists, (kills + assists) / deaths),
    exp = case_when(
      level == 1 ~ 0,
      level == 2 ~ 240,
      level == 3 ~ 640,
      level == 4 ~ 1160,
      level == 5 ~ 1760,
      level == 6 ~ 2440,
      level == 7 ~ 3200,
      level == 8 ~ 4000,
      level == 9 ~ 4900,
      level == 10 ~ 5900,
      level == 11 ~ 7000,
      level == 12 ~ 8200,
      level == 13 ~ 9500,
      level == 14 ~ 10900,
      level == 15 ~ 12400,
      level == 16 ~ 14000,
      level == 17 ~ 15700,
      level == 18 ~ 17500,
      level == 19 ~ 19400,
      level == 20 ~ 21400,
      level == 21 ~ 23600,
      level == 22 ~ 26000,
      level == 23 ~ 28600,
      level == 24 ~ 31400,
      level == 25 ~ 34400,
      level == 26 ~ 38400,
      level == 27 ~ 43400,
      level == 28 ~ 49400,
      level == 29 ~ 56400,
      level == 30 ~ 63900
    )
  )
melee_data <- dota2_data %>% filter(attack_type == "Melee")
ranged_data <- dota2_data %>% filter(attack_type == "Ranged")

# –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–≤—É—Ö –≥—Ä—É–ø–ø
wilcox_test <- wilcox.test(melee_data$gold_per_min, ranged_data$gold_per_min)
p_value <- wilcox_test$p.value

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
mean_melee <- mean(melee_data$gold_per_min, na.rm = TRUE)
mean_ranged <- mean(ranged_data$gold_per_min, na.rm = TRUE)

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
cat("Q18: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≥—Ä—É–ø–ø –ø–æ —Ç–∏–ø—É –∞—Ç–∞–∫–∏\n")
cat("p-value =", p_value, "\n")
if (p_value < 0.05) {
  cat("–ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç–∞.\n")
  if (mean_melee > mean_ranged) {
    cat("–°—Ä–µ–¥–Ω–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å gold_per_min –≤—ã—à–µ –≤ –≥—Ä—É–ø–ø–µ melee.\n")
  } else {
    cat("–°—Ä–µ–¥–Ω–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å gold_per_min –≤—ã—à–µ –≤ –≥—Ä—É–ø–ø–µ ranged.\n")
  }
} else {
  cat("–ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ –Ω–µ –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç–∞. –°—Ä–µ–¥–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ gold_per_min –≤ –æ–±–µ–∏—Ö –≥—Ä—É–ø–ø–∞—Ö –Ω–µ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è.\n")
}


```

p-value: –ó–Ω–∞—á–µ–Ω–∏–µ p-value —Ä–∞–≤–Ω–æ 0, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤—ã—Å–æ–∫—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫—É—é –∑–Ω–∞—á–∏–º–æ—Å—Ç—å. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º –∑–Ω–∞—á–µ–Ω–∏–∏ gold_per_min –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ melee –∏ ranged –ø—Ä–æ–∏–∑–æ—à–ª–∏ —Å–ª—É—á–∞–π–Ω–æ, –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–≤–Ω–∞ –Ω—É–ª—é.

–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ H0: –ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ (H0), –∫–æ—Ç–æ—Ä–∞—è —É—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –Ω–µ—Ç —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º –∑–Ω–∞—á–µ–Ω–∏–∏ gold_per_min –º–µ–∂–¥—É –≥–µ—Ä–æ—è–º–∏ —Å –±–ª–∏–∂–Ω–µ–π –∞—Ç–∞–∫–æ–π (melee) –∏ –≥–µ—Ä–æ—è–º–∏ —Å –¥–∞–ª—å–Ω–µ–π –∞—Ç–∞–∫–æ–π (ranged), –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç–∞. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ä–∞–∑–ª–∏—á–∏—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å—É—â–µ—Å—Ç–≤—É—é—Ç.

–°—Ä–µ–¥–Ω–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å gold_per_min: –°—Ä–µ–¥–Ω–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å gold_per_min –≤—ã—à–µ –≤ –≥—Ä—É–ø–ø–µ melee. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ñ–∞–∫—Ç–æ—Ä–∞–º–∏:

–ò–≥—Ä–æ–≤–∞—è —Ä–æ–ª—å –∏ —Å—Ç–∏–ª—å –∏–≥—Ä—ã: –ì–µ—Ä–æ–∏ —Å –±–ª–∏–∂–Ω–µ–π –∞—Ç–∞–∫–æ–π —á–∞—Å—Ç–æ –∏–≥—Ä–∞—é—Ç –±–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ, –≤–µ–¥—É—Ç –∞–∫—Ç–∏–≤–Ω—É—é –æ—Ö–æ—Ç—É –Ω–∞ –≤—Ä–∞–≥–æ–≤ –∏ —É—á–∞—Å—Ç–≤—É—é—Ç –≤ –¥—Ä–∞–∫–∞—Ö, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –±–æ–ª—å—à–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–æ–ª–æ—Ç–∞ –≤ –º–∏–Ω—É—Ç—É.
–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≥–µ—Ä–æ–µ–≤: –ì–µ—Ä–æ–∏ –±–ª–∏–∂–Ω–µ–≥–æ –±–æ—è –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∏–ª–∏ —Ç–∞–ª–∞–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –∏–º –±—ã—Å—Ç—Ä–µ–µ —É–±–∏–≤–∞—Ç—å –∫—Ä–∏–ø–æ–≤ –∏–ª–∏ –≥–µ—Ä–æ–µ–≤, —á—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∏—Ö –∑–æ–ª–æ—Ç–æ.

–ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –ª–∏–Ω–∏–∏: –ì–µ—Ä–æ–∏ –±–ª–∏–∂–Ω–µ–≥–æ –±–æ—è –º–æ–≥—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∞ –ª–∏–Ω–∏—è—Ö, –≥–¥–µ —É –Ω–∏—Ö –±–æ–ª—å—à–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –¥–ª—è —Ñ–∞—Ä–º–∞ –∏ —É–±–∏–π—Å—Ç–≤–∞ –≤—Ä–∞–≥–æ–≤.


Q19: –í—ã–≤–æ–¥—ã

 
``` {r q19}
p_value_healing <- t_test_healing$p.value
mean_healing <- mean(healing_group$gold_per_min)
mean_non_healing <- mean(non_healing_group$gold_per_min)

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
cat("Q19: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≥—Ä—É–ø–ø –ø–æ –Ω–∞–ª–∏—á–∏—é –ª–µ—á–µ–Ω–∏—è —Å–æ—é–∑–Ω–∏–∫–æ–≤\n")
cat("p-value =", p_value_healing, "\n")
if (p_value_healing < 0.05) {
  cat("–ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ –æ—Ç–≤–µ—Ä–≥–∞–µ—Ç—Å—è.\n")
  if (mean_healing > mean_non_healing) {
    cat("–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å gold_per_min –≤ –≥—Ä—É–ø–ø–µ —Å –ª–µ—á–µ–Ω–∏–µ–º –≤—ã—à–µ.\n")
  } else {
    cat("–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å gold_per_min –≤ –≥—Ä—É–ø–ø–µ –±–µ–∑ –ª–µ—á–µ–Ω–∏—è –≤—ã—à–µ.\n")
  }
} else {
  cat("–ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ –Ω–µ –æ—Ç–≤–µ—Ä–≥–∞–µ—Ç—Å—è.\n")
}

cat("–ö–∞–∫ –≤—ã –¥—É–º–∞–µ—Ç–µ, –ø–æ—á–µ–º—É –≤—ã –ø–æ–ª—É—á–∏–ª–∏ —Ç–∞–∫–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç?\n")
cat("–ú–æ–≥–ª–æ –±—ã—Ç—å —Ç–∞–∫, —á—Ç–æ –≥–µ—Ä–æ–∏ —Å –ª–µ—á–µ–Ω–∏–µ–º —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–ª–∏—Å—å –Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–µ –∫–æ–º–∞–Ω–¥—ã, —á—Ç–æ –º–æ–≥–ª–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Ä–∞–∑–ª–∏—á–∏—é –≤ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è—Ö gold_per_min.\n")
```



``` {r q19.1}
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—Ç—Ä–æ–∫ –ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
cat("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏: ", nrow(dota2_data), "\n")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –Ω–µ—á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –¥–∞–Ω–Ω—ã—Ö
cat("–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –Ω–µ—á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π:\n")
summary(dota2_data)
```


``` {r q19.2}
# –ú–æ–¥–µ–ª–∏ —Å –ª–æ–≥–∞—Ä–∏—Ñ–º–æ–º –∏ –∫–æ—Ä–Ω–µ–º —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º log1p –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å –Ω—É–ª—è–º–∏
model_log <- lm(gold_per_min ~ log1p(assists) + log1p(deaths) + log1p(kills) + log1p(last_hits) + log1p(obs_placed) + log1p(kda_ratio) + log1p(exp) + log1p(hero_healing), data = dota2_data)
model_sqrt <- lm(gold_per_min ~ sqrt(assists) + sqrt(deaths) + sqrt(kills) + sqrt(last_hits) + sqrt(obs_placed) + sqrt(kda_ratio) + sqrt(exp) + sqrt(hero_healing), data = dota2_data)


```


``` {r q19.3}
# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π R^2
r_squared_log <- summary(model_log)$r.squared
adj_r_squared_log <- summary(model_log)$adj.r.squared
r_squared_sqrt <- summary(model_sqrt)$r.squared
adj_r_squared_sqrt <- summary(model_sqrt)$adj.r.squared
```


``` {r q19.4}
# –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
coefficients_log <- summary(model_log)$coefficients
coefficients_sqrt <- summary(model_sqrt)$coefficients

# –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
dota2_data_standardized <- dota2_data %>%
  mutate_at(vars(assists, deaths, kills, last_hits, obs_placed, kda_ratio, exp, hero_healing), scale)

# –ú–æ–¥–µ–ª–∏ —Å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
model_standardized <- lm(gold_per_min ~ assists + deaths + kills + last_hits + obs_placed + kda_ratio + exp + hero_healing, data = dota2_data_standardized)
summary_model_standardized <- summary(model_standardized)
```

Q20


``` {r q20}
# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ –ª–∏–Ω–∏—è–º
lane_1_data <- dota2_data %>% filter(lane == 1)
lane_2_data <- dota2_data %>% filter(lane == 2)
lane_3_data <- dota2_data %>% filter(lane == 3)

# –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ t-—Ç–µ—Å—Ç–æ–≤
t_test_1_2 <- t.test(lane_1_data$gold_per_min, lane_2_data$gold_per_min)
t_test_1_3 <- t.test(lane_1_data$gold_per_min, lane_3_data$gold_per_min)
t_test_2_3 <- t.test(lane_2_data$gold_per_min, lane_3_data$gold_per_min)

# Q20.1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑—ã –æ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ —Å—Ä–µ–¥–Ω–∏—Ö
# H0: –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è gold_per_min —Ä–∞–≤–Ω—ã –¥–ª—è –≤—Å–µ—Ö –ª–∏–Ω–∏–π
# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞: –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è gold_per_min –Ω–µ —Ä–∞–≤–Ω—ã –¥–ª—è –≤—Å–µ—Ö –ª–∏–Ω–∏–π
alpha <- 0.05

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ t-—Ç–µ—Å—Ç–æ–≤
cat("Q20.1: –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –ø–∞—Ä–Ω—ã—Ö –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö t-—Ç–µ—Å—Ç–æ–≤\n")
cat("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã t-—Ç–µ—Å—Ç–æ–≤ –º–µ–∂–¥—É –ª–∏–Ω–∏—è–º–∏:\n")
cat("Lane 1 vs Lane 2: p-value =", t_test_1_2$p.value, "\n")
cat("Lane 1 vs Lane 3: p-value =", t_test_1_3$p.value, "\n")
cat("Lane 2 vs Lane 3: p-value =", t_test_2_3$p.value, "\n")

# –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ H0
cat("\n–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ H0:\n")
if (t_test_1_2$p.value < alpha) {
  cat("–ú–µ–∂–¥—É Lane 1 –∏ Lane 2 —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–∞—è —Ä–∞–∑–Ω–∏—Ü–∞.\n")
} else {
  cat("–ú–µ–∂–¥—É Lane 1 –∏ Lane 2 –Ω–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–æ–π —Ä–∞–∑–Ω–∏—Ü—ã.\n")
}
if (t_test_1_3$p.value < alpha) {
  cat("–ú–µ–∂–¥—É Lane 1 –∏ Lane 3 —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–∞—è —Ä–∞–∑–Ω–∏—Ü–∞.\n")
} else {
  cat("–ú–µ–∂–¥—É Lane 1 –∏ Lane 3 –Ω–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–æ–π —Ä–∞–∑–Ω–∏—Ü—ã.\n")
}
if (t_test_2_3$p.value < alpha) {
  cat("–ú–µ–∂–¥—É Lane 2 –∏ Lane 3 —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–∞—è —Ä–∞–∑–Ω–∏—Ü–∞.\n")
} else {
  cat("–ú–µ–∂–¥—É Lane 2 –∏ Lane 3 –Ω–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–æ–π —Ä–∞–∑–Ω–∏—Ü—ã.\n")
}

# Q20.2 p-value –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏–π
cat("\nQ20.2: p-value –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏–π\n")
cat("Lane 1 vs Lane 2: p-value =", t_test_1_2$p.value, "\n")
cat("Lane 1 vs Lane 3: p-value =", t_test_1_3$p.value, "\n")
cat("Lane 2 vs Lane 3: p-value =", t_test_2_3$p.value, "\n")

# Q20.3
cat("\nQ20.3: –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤\n")
cat("–ü–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω—ã —Å —Ä–∞–∑–ª–∏—á–∏—è–º–∏ –≤ –∏–≥—Ä–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏—è—Ö –∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è–º–∏ –∫–∞–∂–¥–æ–π –ª–∏–Ω–∏–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ –ª—ë–≥–∫–æ–π –ª–∏–Ω–∏–∏ (easy lane) –∏–≥—Ä–æ–∫–∏ –º–æ–≥—É—Ç –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ –ø–æ–ª—É—á–∞—Ç—å –∑–æ–ª–æ—Ç–æ –∏ –æ–ø—ã—Ç, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–º –∑–Ω–∞—á–µ–Ω–∏—è–º gold_per_min. –ù–∞ —Å–ª–æ–∂–Ω–æ–π –ª–∏–Ω–∏–∏ (hard lane) –∏–≥—Ä–æ–∫–∏ —Å—Ç–∞–ª–∫–∏–≤–∞—é—Ç—Å—è —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —É–≥—Ä–æ–∑, —á—Ç–æ –º–æ–∂–µ—Ç —Å–Ω–∏–∂–∞—Ç—å –∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∑–æ–ª–æ—Ç–∞ –∏ –æ–ø—ã—Ç–∞. –≠—Ç–∏ —Ä–∞–∑–ª–∏—á–∏—è –º–æ–≥—É—Ç –æ–±—ä—è—Å–Ω—è—Ç—å –∑–Ω–∞—á–∏–º—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É –ª–∏–Ω–∏—è–º–∏.\n")

```

Q21

``` {r q21}
# –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º
dota2_data_path <- "C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\dota2_proleague.csv"
level_exp_path <- "C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\level_exp.json"
heroes_data_path <- "C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\heroes.csv"

# –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ CSV —Ñ–∞–π–ª–æ–≤
dota2_data <- read.csv(dota2_data_path)
heroes_data <- read.csv(heroes_data_path)

# –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ JSON —Ñ–∞–π–ª–∞
level_exp <- fromJSON(level_exp_path)

# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ JSON –≤ data frame
level_exp_df <- data.frame(level = as.numeric(names(level_exp)), exp = unlist(level_exp))

# –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ —É—Ä–æ–≤–Ω—é –æ–ø—ã—Ç–∞
dota2_data <- dota2_data %>%
  left_join(level_exp_df, by = c("level" = "level"))

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≥–µ—Ä–æ—è—Ö
dota2_data <- dota2_data %>%
  left_join(heroes_data, by = c("hero_id" = "id"))

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø –Ω–∞ –æ—Å–Ω–æ–≤–µ primary_attr
dota2_data <- dota2_data %>%
  mutate(
    str_attr = ifelse(primary_attr == "str", 1, 0),
    agi_attr = ifelse(primary_attr == "agi", 1, 0),
    int_attr = ifelse(primary_attr == "int", 1, 0),
    all_attr = ifelse(primary_attr == "all", 1, 0)
  )

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è t-—Ç–µ—Å—Ç–∞ –º–µ–∂–¥—É –¥–≤—É–º—è –≥—Ä—É–ø–ø–∞–º–∏
perform_t_test <- function(data, group1, group2) {
  group1_data <- data %>% filter(get(group1) == 1)
  group2_data <- data %>% filter(get(group2) == 1)
  
  t_test_result <- t.test(group1_data$gold_per_min, group2_data$gold_per_min, paired = FALSE)
  return(t_test_result)
}

# –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ t-—Ç–µ—Å—Ç–æ–≤ –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä –≥—Ä—É–ø–ø
tests <- list()
groups <- c("str_attr", "agi_attr", "int_attr", "all_attr")

for (i in 1:(length(groups) - 1)) {
  for (j in (i + 1):length(groups)) {
    group1 <- groups[i]
    group2 <- groups[j]
    test_result <- perform_t_test(dota2_data, group1, group2)
    tests[[paste(group1, group2, sep = "_vs_")]] <- test_result
  }
}

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
cat("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã t-—Ç–µ—Å—Ç–æ–≤:\n")
for (test_name in names(tests)) {
  cat("\n", test_name, "\n")
  cat("p-value:", tests[[test_name]]$p.value, "\n")
  if (tests[[test_name]]$p.value < 0.05) {
    cat("H0 –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è: –µ—Å—Ç—å –∑–Ω–∞—á–∏–º–∞—è —Ä–∞–∑–Ω–∏—Ü–∞.\n")
  } else {
    cat("H0 –Ω–µ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è: –Ω–µ—Ç –∑–Ω–∞—á–∏–º–æ–π —Ä–∞–∑–Ω–∏—Ü—ã.\n")
  }
}

```

Q22

``` {r q22}
dota2_data_path <- "C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\dota2_proleague.csv"
level_exp_path <- "C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\level_exp.json"
heroes_data_path <- "C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\heroes.csv"
dota2_data <- read.csv(dota2_data_path)
heroes_data <- read.csv(heroes_data_path)
level_exp <- fromJSON(level_exp_path)
level_exp_df <- data.frame(level = as.numeric(names(level_exp)), exp = unlist(level_exp))
dota2_data <- dota2_data %>%
  left_join(level_exp_df, by = c("level" = "level")) %>%
  select(-level)
dota2_data <- dota2_data %>%
  left_join(heroes_data %>%
              select(id, attack_type, primary_attr), by = c("hero_id" = "id")) %>%
  mutate(
    ranged_attack = ifelse(attack_type == "Ranged", 1, 0),
    melee_attack = ifelse(attack_type == "Melee", 1, 0),
    str_attr = ifelse(primary_attr == "str", 1, 0),
    agi_attr = ifelse(primary_attr == "agi", 1, 0),
    int_attr = ifelse(primary_attr == "int", 1, 0),
    all_attr = ifelse(primary_attr == "all", 1, 0),
    hero_healing = ifelse(hero_healing == 0, 1, 0),
    healing_zero = ifelse(hero_healing == 0, 1, 0),
    lane_1 = ifelse(lane == 1, 1, 0),
    lane_2 = ifelse(lane == 2, 1, 0),
    lane_3 = ifelse(lane == 3, 1, 0)
  ) %>%
  select(-attack_type, -primary_attr, -lane)
dota2_data$start_time <- as.POSIXct(dota2_data$start_time)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
required_cols <- c("lane_3", "ranged_attack", "all_attr", "lane_1", "lane_2")

missing_cols <- setdiff(required_cols, names(dota2_data))
if(length(missing_cols) > 0) {
  cat("–°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:", missing_cols, "\n")
  for (col in missing_cols) {
    dota2_data[[col]] <- 0
  }
}

# –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
dota2_data <- dota2_data %>%
  select(-lane_3, -ranged_attack, -all_attr)

# –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è —Å –æ–¥–Ω–æ–π –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
single_var_model <- lm(gold_per_min ~ last_hits, data = dota2_data)
summary_single_var <- summary(single_var_model)

# –ó–Ω–∞—á–µ–Ω–∏–µ R¬≤ –¥–ª—è –º–æ–¥–µ–ª–∏ —Å –æ–¥–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
r_squared_single <- summary_single_var$r.squared

cat("–ó–Ω–∞—á–µ–Ω–∏–µ R¬≤ –¥–ª—è –º–æ–¥–µ–ª–∏ —Å –æ–¥–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π:", r_squared_single, "\n")
cat("–ú–æ–¥–µ–ª—å –æ–±—ä—è—Å–Ω—è–µ—Ç", round(r_squared_single * 100, 2), "% –∏–∑–º–µ–Ω—á–∏–≤–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π gold_per_min.\n")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
n_obs <- nrow(dota2_data)
all_vars <- c("duration", "assists", "deaths", "kills", "teamfight_participation",
              "camps_stacked", "creeps_stacked", "last_hits", "lane_kills", "firstblood_claimed",
              "obs_placed", "observer_kills", "ancient_kills", "isRadiant",
              "win", "kda", "exp", "lane_1", "lane_2", "str_attr",
              "agi_attr", "int_attr", "melee_attack", "hero_healing", "healing_zero")

# –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –¥–ª–∏–Ω—É
for (var in all_vars) {
  if (length(dota2_data[[var]]) != n_obs) {
    stop(paste("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è", var, "–∏–º–µ–µ—Ç —Ä–∞–∑–Ω—É—é –¥–ª–∏–Ω—É."))
  }
}

# –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è —Å–æ –≤—Å–µ–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
full_model <- lm(gold_per_min ~ duration + assists + deaths + kills + teamfight_participation +
                   camps_stacked + creeps_stacked + last_hits + lane_kills + firstblood_claimed +
                   obs_placed + observer_kills + ancient_kills + isRadiant +
                   win + kda + exp + lane_1 + lane_2 + str_attr +
                   agi_attr + int_attr + melee_attack + hero_healing + healing_zero,
                 data = dota2_data)

summary_full <- summary(full_model)

# –ó–Ω–∞—á–µ–Ω–∏–µ R¬≤ –¥–ª—è –ø–æ–ª–Ω–æ–π –º–æ–¥–µ–ª–∏
r_squared_full <- summary_full$r.squared

cat("–ó–Ω–∞—á–µ–Ω–∏–µ R¬≤ –¥–ª—è –ø–æ–ª–Ω–æ–π –º–æ–¥–µ–ª–∏:", r_squared_full, "\n")
cat("–ü–æ–ª–Ω–∞—è –º–æ–¥–µ–ª—å –æ–±—ä—è—Å–Ω—è–µ—Ç", round(r_squared_full * 100, 2), "% –∏–∑–º–µ–Ω—á–∏–≤–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π gold_per_min.\n")

# –ó–Ω–∞—á–∏–º–æ—Å—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
significant_coefficients <- summary_full$coefficients[, 4] < 0.05
significant_vars <- names(summary_full$coefficients[significant_coefficients, 1])

cat("–ó–Ω–∞—á–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∏ Œ±=0.05:\n")
print(significant_vars)

# –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –∑–Ω–∞—á–∏–º—ã—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
cat("–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –∑–Ω–∞—á–∏–º—ã—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤:\n")
print(summary_full$coefficients[significant_coefficients, ])

```
Q23

``` {r q23}
dota2_data_path <- "C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\dota2_proleague.csv"
level_exp_path <- "C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\level_exp.json"
heroes_data_path <- "C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\heroes.csv"
dota2_data <- read.csv(dota2_data_path)
heroes_data <- read.csv(heroes_data_path)
level_exp <- fromJSON(level_exp_path)
level_exp_df <- data.frame(level = as.numeric(names(level_exp)), exp = unlist(level_exp))
dota2_data <- dota2_data %>%
  left_join(level_exp_df, by = c("level" = "level")) %>%
  select(-level)
dota2_data <- dota2_data %>%
  left_join(heroes_data %>%
              select(id, attack_type, primary_attr), by = c("hero_id" = "id")) %>%
  mutate(
    ranged_attack = ifelse(attack_type == "Ranged", 1, 0),
    melee_attack = ifelse(attack_type == "Melee", 1, 0),
    str_attr = ifelse(primary_attr == "str", 1, 0),
    agi_attr = ifelse(primary_attr == "agi", 1, 0),
    int_attr = ifelse(primary_attr == "int", 1, 0),
    all_attr = ifelse(primary_attr == "all", 1, 0),
    hero_healing = ifelse(hero_healing == 0, 1, 0),
    healing_zero = ifelse(hero_healing == 0, 1, 0),
    lane_1 = ifelse(lane == 1, 1, 0),
    lane_2 = ifelse(lane == 2, 1, 0),
    lane_3 = ifelse(lane == 3, 1, 0)
  ) %>%
  select(-attack_type, -primary_attr, -lane)
dota2_data$start_time <- as.POSIXct(dota2_data$start_time)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
required_cols <- c("lane_3", "ranged_attack", "all_attr", "lane_1", "lane_2")

missing_cols <- setdiff(required_cols, names(dota2_data))
if(length(missing_cols) > 0) {
  cat("–°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:", missing_cols, "\n")
  for (col in missing_cols) {
    dota2_data[[col]] <- 0
  }
}

# –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
dota2_data <- dota2_data %>%
  select(-lane_3, -ranged_attack, -all_attr)

# –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è —Å –æ–¥–Ω–æ–π –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
single_var_model <- lm(gold_per_min ~ last_hits, data = dota2_data)
summary_single_var <- summary(single_var_model)

# –ó–Ω–∞—á–µ–Ω–∏–µ R¬≤ –¥–ª—è –º–æ–¥–µ–ª–∏ —Å –æ–¥–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
r_squared_single <- summary_single_var$r.squared

cat("–ó–Ω–∞—á–µ–Ω–∏–µ R¬≤ –¥–ª—è –º–æ–¥–µ–ª–∏ —Å –æ–¥–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π:", r_squared_single, "\n")
cat("–ú–æ–¥–µ–ª—å –æ–±—ä—è—Å–Ω—è–µ—Ç", round(r_squared_single * 100, 2), "% –∏–∑–º–µ–Ω—á–∏–≤–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π gold_per_min.\n")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
n_obs <- nrow(dota2_data)
all_vars <- c("duration", "assists", "deaths", "kills", "teamfight_participation",
              "camps_stacked", "creeps_stacked", "last_hits", "lane_kills", "firstblood_claimed",
              "obs_placed", "observer_kills", "ancient_kills", "isRadiant",
              "win", "kda", "exp", "lane_1", "lane_2", "str_attr",
              "agi_attr", "int_attr", "melee_attack", "hero_healing", "healing_zero")

# –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –¥–ª–∏–Ω—É
for (var in all_vars) {
  if (length(dota2_data[[var]]) != n_obs) {
    stop(paste("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è", var, "–∏–º–µ–µ—Ç —Ä–∞–∑–Ω—É—é –¥–ª–∏–Ω—É."))
  }
}

# –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è —Å–æ –≤—Å–µ–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
full_model <- lm(gold_per_min ~ duration + assists + deaths + kills + teamfight_participation +
                   camps_stacked + creeps_stacked + last_hits + lane_kills + firstblood_claimed +
                   obs_placed + observer_kills + ancient_kills + isRadiant +
                   win + kda + exp + lane_1 + lane_2 + str_attr +
                   agi_attr + int_attr + melee_attack + hero_healing + healing_zero,
                 data = dota2_data)

summary_full <- summary(full_model)

# –ó–Ω–∞—á–µ–Ω–∏–µ R¬≤ –¥–ª—è –ø–æ–ª–Ω–æ–π –º–æ–¥–µ–ª–∏
r_squared_full <- summary_full$r.squared
adj_r_squared_full <- summary_full$adj.r.squared

cat("–ó–Ω–∞—á–µ–Ω–∏–µ R¬≤ –¥–ª—è –ø–æ–ª–Ω–æ–π –º–æ–¥–µ–ª–∏:", r_squared_full, "\n")
cat("–ü–æ–ª–Ω–∞—è –º–æ–¥–µ–ª—å –æ–±—ä—è—Å–Ω—è–µ—Ç", round(r_squared_full * 100, 2), "% –∏–∑–º–µ–Ω—á–∏–≤–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π gold_per_min.\n")
cat("–ó–Ω–∞—á–µ–Ω–∏–µ adj. R¬≤ –¥–ª—è –ø–æ–ª–Ω–æ–π –º–æ–¥–µ–ª–∏:", adj_r_squared_full, "\n")

# –ó–Ω–∞—á–∏–º–æ—Å—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
significant_coefficients <- summary_full$coefficients[, 4] < 0.05
significant_vars <- names(summary_full$coefficients[significant_coefficients, 1])

cat("–ó–Ω–∞—á–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∏ Œ±=0.05:\n")
print(significant_vars)

# –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –∑–Ω–∞—á–∏–º—ã—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
cat("–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –∑–Ω–∞—á–∏–º—ã—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤:\n")
print(summary_full$coefficients[significant_coefficients, ])

```
duration (-0.1056): –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ —Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏–≥—Ä—ã –∑–æ–ª–æ—Ç–æ –≤ –º–∏–Ω—É—Ç—É —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º, —Ç–∞–∫ –∫–∞–∫ –≤ –¥–æ–ª–≥–∏—Ö –∏–≥—Ä–∞—Ö –∏–≥—Ä–æ–∫–∏ –∏–º–µ—é—Ç –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è —Ñ–∞—Ä–º–∞.
teamfight_participation (-23.6569): –°–Ω–∏–∂–µ–Ω–∏–µ –∑–æ–ª–æ—Ç–∞ –≤ –º–∏–Ω—É—Ç—É —Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º —É—á–∞—Å—Ç–∏—è –≤ –∫–æ–º–∞–Ω–¥–Ω—ã—Ö —Å—Ä–∞–∂–µ–Ω–∏—è—Ö —Ç–∞–∫–∂–µ –∫–∞–∂–µ—Ç—Å—è –Ω–µ–æ–±—ã—á–Ω—ã–º, –ø–æ—Å–∫–æ–ª—å–∫—É —É—á–∞—Å—Ç–∏–µ –≤ –∫–æ–º–∞–Ω–¥–Ω—ã—Ö –±–æ—è—Ö —á–∞—Å—Ç–æ –ø—Ä–∏–Ω–æ—Å–∏—Ç –±–æ–ª—å—à–µ –∑–æ–ª–æ—Ç–∞ –∑–∞ —Å—á—ë—Ç —É–±–∏–π—Å—Ç–≤ –∏ –∞—Å—Å–∏—Å—Ç–æ–≤.
str_attr (13.1963) –∏ agi_attr (20.6380): –í—ã—Å–æ–∫–∏–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Å–∏–ª–æ–≤—ã—Ö –∏ –ª–æ–≤–∫–æ—Å—Ç–Ω—ã—Ö –≥–µ—Ä–æ–µ–≤ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ —ç—Ç–∏ –∞—Ç—Ä–∏–±—É—Ç—ã –≤–Ω–æ—Å—è—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –≤–∫–ª–∞–¥ –≤ –∑–æ–ª–æ—Ç–æ –≤ –º–∏–Ω—É—Ç—É. –û–¥–Ω–∞–∫–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è int_attr (-8.1379) —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –æ–±—Ä–∞—Ç–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –¥–ª—è –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º, —É—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ –º–Ω–æ–≥–∏–µ –≥–µ—Ä–æ–∏ —Å –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º —Ç–∞–∫–∂–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã –≤ —Ñ–∞—Ä–º–µ.

–ó–Ω–∞—á–µ–Ω–∏–µ R¬≤ –¥–ª—è –¥–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏: 0.912808
–ó–Ω–∞—á–µ–Ω–∏–µ adj. R¬≤ –¥–ª—è –¥–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏: 0.9127976
–ó–Ω–∞—á–µ–Ω–∏—è R¬≤ –∏ adj. R¬≤ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤–æ–∑—Ä–æ—Å–ª–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –º–æ–¥–µ–ª—å—é —Å –æ–¥–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (–≥–¥–µ R¬≤ –±—ã–ª–æ 0.6771551). –≠—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –ø–æ–ª–Ω–∞—è –º–æ–¥–µ–ª—å –æ–±—ä—è—Å–Ω—è–µ—Ç –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å –∏–∑–º–µ–Ω—á–∏–≤–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π gold_per_min.

Q24

``` {r q24}
# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è Q24.1
cat("Q24.1: –ó–Ω–∞—á–µ–Ω–∏—è R^2 –¥–ª—è –º–æ–¥–µ–ª–µ–π\n")
cat("–õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å: R^2 =", r_squared_log, ", adj. R^2 =", adj_r_squared_log, "\n")
cat("–ú–æ–¥–µ–ª—å —Å –∫–æ—Ä–Ω–µ–º: R^2 =", r_squared_sqrt, ", adj. R^2 =", adj_r_squared_sqrt, "\n")
cat("–ú–æ–¥–µ–ª—å —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏: R^2 =", summary_model_standardized$r.squared, ", adj. R^2 =", summary_model_standardized$adj.r.squared, "\n")

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è Q24.2
cat("\nQ24.2: –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤\n")
cat("–õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å:\n")
print(coefficients_log)
cat("\n–ú–æ–¥–µ–ª—å —Å –∫–æ—Ä–Ω–µ–º:\n")
print(coefficients_sqrt)
cat("\n–ú–æ–¥–µ–ª—å —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:\n")
print(summary_model_standardized$coefficients)
```
–ó–Ω–∞—á–µ–Ω–∏–µ R^2 –¥–ª—è –º–æ–¥–µ–ª–∏ —Å –∫–æ—Ä–Ω–µ–º —è–≤–ª—è–µ—Ç—Å—è —Å–∞–º—ã–º –≤—ã—Å–æ–∫–∏–º, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ —ç—Ç–∞ –º–æ–¥–µ–ª—å –ª—É—á—à–µ –≤—Å–µ–≥–æ –æ–±—ä—è—Å–Ω—è–µ—Ç –≤–∞—Ä–∏–∞—Ü–∏—é –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π gold_per_min.
  
–õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å –∏–º–µ–µ—Ç —Å–∞–º–æ–µ –Ω–∏–∑–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ R^2, –Ω–æ –≤—Å–µ –∂–µ –æ–Ω–∞ –¥–æ–≤–æ–ª—å–Ω–æ –≤—ã—Å–æ–∫–∞.

–ú–æ–¥–µ–ª—å —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ R^2 –º–µ–∂–¥—É –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–π –º–æ–¥–µ–ª—å—é –∏ –º–æ–¥–µ–ª—å—é —Å –∫–æ—Ä–Ω–µ–º.


–í –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–π –º–æ–¥–µ–ª–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–∞ gold_per_min, –∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ ‚Äî –Ω–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ.
–í –º–æ–¥–µ–ª–∏ —Å –∫–æ—Ä–Ω–µ–º —Ç–∞–∫–∂–µ –Ω–∞–±–ª—é–¥–∞—é—Ç—Å—è –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –≤–ª–∏—è–Ω–∏—è, –æ–¥–Ω–∞–∫–æ –∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç–ª–∏—á–∞—é—Ç—Å—è.
–í –º–æ–¥–µ–ª–∏ —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –ø–æ–∑–≤–æ–ª—è—é—Ç —Å—Ä–∞–≤–Ω–∏—Ç—å –≤–ª–∏—è–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ.

Q25

``` {r q25}
dota2_data <- read.csv("C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\dota2_proleague.csv")
dota2_data <- dota2_data %>%
  select(-c(X, player_slot, account_id, additional_units, patch, region, lose, radiant_win))
dota2_data <- dota2_data %>%
  filter(game_mode == 2) %>%
  na.omit()
heroes_data <- read.csv("C:\\Users\\–ï–≥–æ—Ä\\Downloads\\rppd\\heroes.csv")
heroes_data <- heroes_data %>%
  rename(hero_id = id)
dota2_data <- dota2_data %>%
  left_join(heroes_data, by = "hero_id")
dota2_data <- dota2_data %>%
  mutate(
    kda_ratio = ifelse(deaths == 0, kills + assists, (kills + assists) / deaths),
    exp = case_when(
      level == 1 ~ 0,
      level == 2 ~ 240,
      level == 3 ~ 640,
      level == 4 ~ 1160,
      level == 5 ~ 1760,
      level == 6 ~ 2440,
      level == 7 ~ 3200,
      level == 8 ~ 4000,
      level == 9 ~ 4900,
      level == 10 ~ 5900,
      level == 11 ~ 7000,
      level == 12 ~ 8200,
      level == 13 ~ 9500,
      level == 14 ~ 10900,
      level == 15 ~ 12400,
      level == 16 ~ 14000,
      level == 17 ~ 15700,
      level == 18 ~ 17500,
      level == 19 ~ 19400,
      level == 20 ~ 21400,
      level == 21 ~ 23600,
      level == 22 ~ 26000,
      level == 23 ~ 28600,
      level == 24 ~ 31400,
      level == 25 ~ 34400,
      level == 26 ~ 38400,
      level == 27 ~ 43400,
      level == 28 ~ 49400,
      level == 29 ~ 56400,
      level == 30 ~ 63900
    )
  )

# –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–∫–ª–∞–¥–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ GPM
model <- lm(gold_per_min ~ assists + deaths + kills + last_hits + obs_placed + kda_ratio + exp + hero_healing, data = dota2_data)

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
coefficients <- summary(model)$coefficients

# Q25.1: –¢—Ä–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º –≤–∫–ª–∞–¥–æ–º
positive_contributors <- coefficients[order(coefficients[, "Estimate"], decreasing = TRUE), ][1:3, ]
positive_contributors

# Q25.2: –¢—Ä–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º –≤–∫–ª–∞–¥–æ–º
negative_contributors <- coefficients[order(coefficients[, "Estimate"]), ][1:3, ]
negative_contributors

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
cat("Q25.1: –¢—Ä–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –≤–Ω–æ—Å—è—â–∏–µ –Ω–∞–∏–±–æ–ª—å—à–∏–π –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –≤–∫–ª–∞–¥ –≤ GPM:\n")
print(positive_contributors)
cat("\n–û–∂–∏–¥–∞–µ–º–æ –ª–∏ —ç—Ç–æ? –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:\n")

# 1. Kills (–£–±–∏–π—Å—Ç–≤–∞): –£–±–∏–π—Å—Ç–≤–∞ –≥–µ—Ä–æ–µ–≤ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞ –Ω–∞–ø—Ä—è–º—É—é –ø—Ä–∏–Ω–æ—Å—è—Ç –∑–æ–ª–æ—Ç–æ –∏–≥—Ä–æ–∫—É, –ø–æ—ç—Ç–æ–º—É –∏—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –≤–∫–ª–∞–¥ –≤ GPM –æ–∂–∏–¥–∞–µ–º –∏ –ª–æ–≥–∏—á–µ–Ω.
# 2. Assists (–ê—Å—Å–∏—Å—Ç—ã): –ê—Å—Å–∏—Å—Ç—ã —Ç–∞–∫–∂–µ –ø—Ä–∏–Ω–æ—Å—è—Ç –∑–æ–ª–æ—Ç–æ –∏–≥—Ä–æ–∫—É, —Ö–æ—Ç—è –∏ –≤ –º–µ–Ω—å—à–µ–π —Å—Ç–µ–ø–µ–Ω–∏, —á–µ–º —É–±–∏–π—Å—Ç–≤–∞, –ø–æ—ç—Ç–æ–º—É –∏—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –≤–∫–ª–∞–¥ –≤ GPM —Ç–∞–∫–∂–µ –æ–∂–∏–¥–∞–µ–º.
# 3. Last_hits (–ü–æ—Å–ª–µ–¥–Ω–∏–µ —É–¥–∞—Ä—ã): –ü–æ—Å–ª–µ–¥–Ω–∏–µ —É–¥–∞—Ä—ã –ø–æ –∫—Ä–∏–ø–∞–º —è–≤–ª—è—é—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∑–æ–ª–æ—Ç–∞ –¥–ª—è –≥–µ—Ä–æ–µ–≤, –ø–æ—ç—Ç–æ–º—É –∏—Ö –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –≤–∫–ª–∞–¥ –≤ GPM –≤–ø–æ–ª–Ω–µ –æ–∂–∏–¥–∞–µ–º.

# –û—Ç–≤–µ—Ç: (Kills, Assists, Last_hits)
# –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: –£–±–∏–π—Å—Ç–≤–∞ –∏ –∞—Å—Å–∏—Å—Ç—ã –Ω–∞–ø—Ä—è–º—É—é –ø—Ä–∏–Ω–æ—Å—è—Ç –∑–æ–ª–æ—Ç–æ, –∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —É–¥–∞—Ä—ã –ø–æ –∫—Ä–∏–ø–∞–º —è–≤–ª—è—é—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∑–æ–ª–æ—Ç–∞.

cat("\nQ25.2: –¢—Ä–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –≤–Ω–æ—Å—è—â–∏–µ –Ω–∞–∏–±–æ–ª—å—à–∏–π –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –≤–∫–ª–∞–¥ –≤ GPM:\n")
print(negative_contributors)
cat("\n–û–∂–∏–¥–∞–µ–º–æ –ª–∏ —ç—Ç–æ? –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:\n")

# 1. Deaths (–°–º–µ—Ä—Ç–∏): –°–º–µ—Ä—Ç–∏ –≥–µ—Ä–æ—è –Ω–∞–ø—Ä—è–º—É—é —Å–Ω–∏–∂–∞—é—Ç –µ–≥–æ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Ñ–∞—Ä–º–∏—Ç—å –∑–æ–ª–æ—Ç–æ, —Ç–∞–∫ –∫–∞–∫ –≥–µ—Ä–æ–π –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ –º–æ–∂–µ—Ç —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ –∏–≥—Ä–µ –∏ —É–±–∏–≤–∞—Ç—å –∫—Ä–∏–ø–æ–≤ –∏–ª–∏ –≥–µ—Ä–æ–µ–≤, —á—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç –∏—Ö –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –≤–∫–ª–∞–¥ –≤ GPM.
# 2. Obs_placed (–ü–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –æ–±—Å–µ—Ä–≤–µ—Ä—ã): –ü–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –æ–±—Å–µ—Ä–≤–µ—Ä—ã (–≤–∞—Ä–¥—ã) –Ω–µ –Ω–∞–ø—Ä—è–º—É—é —Å–≤—è–∑–∞–Ω—ã —Å —Ñ–∞—Ä–º–æ–º –∑–æ–ª–æ—Ç–∞ –∏ –º–æ–≥—É—Ç –¥–∞–∂–µ –æ—Ç–≤–ª–µ–∫–∞—Ç—å –∏–≥—Ä–æ–∫–∞ –æ—Ç —Ñ–∞—Ä–º–∞, —á—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç –∏—Ö –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –≤–∫–ª–∞–¥ –≤ GPM.
# 3. Hero_healing (–õ–µ—á–µ–Ω–∏–µ –≥–µ—Ä–æ—è): –õ–µ—á–µ–Ω–∏–µ –≥–µ—Ä–æ—è —Ç–∞–∫–∂–µ –Ω–µ –Ω–∞–ø—Ä—è–º—É—é —Å–≤—è–∑–∞–Ω–æ —Å —Ñ–∞—Ä–º–æ–º –∑–æ–ª–æ—Ç–∞ –∏ –º–æ–∂–µ—Ç –æ—Ç–≤–ª–µ–∫–∞—Ç—å –æ—Ç –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π –∏–≥—Ä—ã –∏ —É–±–∏–π—Å—Ç–≤, —á—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç –∏—Ö –Ω–µ–±–æ–ª—å—à–æ–π –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –≤–∫–ª–∞–¥ –≤ GPM.

# –û—Ç–≤–µ—Ç: (Deaths, Obs_placed, Hero_healing)
# –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: –°–º–µ—Ä—Ç–∏ —Å–Ω–∏–∂–∞—é—Ç —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Ñ–∞—Ä–º–∏—Ç—å –∑–æ–ª–æ—Ç–æ, –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –æ–±—Å–µ—Ä–≤–µ—Ä—ã –∏ –ª–µ—á–µ–Ω–∏–µ –Ω–µ —Å–≤—è–∑–∞–Ω—ã –Ω–∞–ø—Ä—è–º—É—é —Å —Ñ–∞—Ä–º–æ–º –∑–æ–ª–æ—Ç–∞ –∏ –º–æ–≥—É—Ç –æ—Ç–≤–ª–µ–∫–∞—Ç—å –æ—Ç –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π –∏–≥—Ä—ã.

```


Q26

Q26: –í—ã–≤–æ–¥—ã
–ö–∞–∫–∏–µ –≤—ã–≤–æ–¥—ã –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∏–∑ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞?

–ù–∞–∏–±–æ–ª—å—à–µ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ gold_per_min –æ–∫–∞–∑—ã–≤–∞—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ last_hits, kills –∏ exp, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è –≤—ã—Å–æ–∫–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π –∏ –∑–Ω–∞—á–∏–º–æ—Å—Ç—å—é –≤ —Ä–µ–≥—Ä–µ—Å—Å–∏—è—Ö.
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∞—Ä–∏—Ñ–º–æ–≤ –∏ –∫–æ—Ä–Ω–µ–π –¥–ª—è —Å–∫–æ—à–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —É–ª—É—á—à–∞–µ—Ç –æ–±—ä—è—Å–Ω–∏—Ç–µ–ª—å–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏.
–ü–æ–±–µ–¥–∞ –≤ –∏–≥—Ä–µ –∏ —É—á–∞—Å—Ç–∏–µ –≤ –∫–æ–º–∞–Ω–¥–Ω—ã—Ö –±–æ—è—Ö —Ç–∞–∫–∂–µ —è–≤–ª—è—é—Ç—Å—è –∑–Ω–∞—á–∏–º—ã–º–∏ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞–º–∏ gold_per_min.
–ß—Ç–æ —É–¥–∞–ª–æ—Å—å —Å–¥–µ–ª–∞—Ç—å, –∞ —á—Ç–æ –Ω–µ —É–¥–∞–ª–æ—Å—å?

–£–¥–∞–ª–æ—Å—å:
–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –≤–ª–∏—è—é—â–∏–µ –Ω–∞ gold_per_min.
–£–ª—É—á—à–∏—Ç—å –º–æ–¥–µ–ª—å –ø—É—Ç–µ–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å–∫–æ—à–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.
–ü—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤.
–ù–µ —É–¥–∞–ª–æ—Å—å:
–ü–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å —Ä–∞–∑–Ω—ã–º–∏ –¥–ª–∏–Ω–∞–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –±–µ–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.
–ò–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö –∏ –∏—Ö –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–µ.


–ö–∞–∫ –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã —É–ª—É—á—à–∏—Ç—å —Ä–∞–±–æ—Ç—É?

–†–∞–∑–±–æ—Ä –ø–æ–¥–≥—Ä—É–ø–ø: –ü—Ä–æ–≤–µ—Å—Ç–∏ –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–æ–¥–≥—Ä—É–ø–ø (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ —Ä–æ–ª—è–º –≥–µ—Ä–æ–µ–≤, —Ç–∏–ø—É –∞—Ç–∞–∫–∏, –ª–∏–Ω–∏–∏).
–ë–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö: –í–∫–ª—é—á–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –º–∞—Ç—á–∞—Ö –∏ –≥–µ—Ä–æ—è—Ö –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –º–æ–¥–µ–ª–∏.
–î—Ä—É–≥–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ –ø—Ä–µ–¥–º–µ—Ç—ã, –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–Ω—ã–µ –≥–µ—Ä–æ—è–º–∏, –∏ –∏—Ö –¥–µ–π—Å—Ç–≤–∏—è –≤ –∏–≥—Ä–µ.
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –º–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è gold_per_min.